<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>이미지 썸네일 그리드 (PC 6열 / 모바일 2열)</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🧩</text></svg>">

<style>
/* =========================
   테마 변수 (라이트/다크)
   ========================= */
:root{
  --background-color: #f4f6f9;
  --panel-bg: #ffffff;
  --panel-border: #e0e6ed;
  --text-primary: #2c3e50;
  --text-secondary: #8a95a5;
  --header-bg: #2c3e50;
  --accent-primary: #3498db;
  --accent-primary-dark: #2980b9;
  --accent-secondary: #2ecc71;
  --accent-secondary-dark: #27ae60;
  --input-bg: #ffffff;
  --input-border: #dce1e6;
  --shadow: rgba(44, 62, 80, 0.1);
  --inactive-tab-bg: #5f7a95;

  --font-primary: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, 'Noto Sans KR', sans-serif;
  --font-secondary: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, 'Noto Sans KR', sans-serif;
}

body.dark-mode{
  --background-color: #1c2128;
  --panel-bg: #2d333b;
  --panel-border: #444c56;
  --text-primary: #e6edf3;
  --text-secondary: #909dab;
  --header-bg: #2d333b;
  --accent-primary: #58a6ff;
  --accent-primary-dark: #388bfd;
  --accent-secondary: #34d399;
  --accent-secondary-dark: #10b981;
  --input-bg: #22272e;
  --input-border: #444c56;
  --shadow: rgba(0,0,0,0.4);
  --inactive-tab-bg: #444c56;
}

/* =========================
   기본 레이아웃/타이포
   ========================= */
*{ box-sizing: border-box; }
html, body{ height:100%; }
body{
  margin:0;
  font-family: var(--font-secondary);
  background: var(--background-color);
  color: var(--text-primary);
  transition: background-color .25s, color .25s;
}

.container{
  max-width: 1100px;
  margin: 0 auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* 헤더 */
.app-header{
  background: var(--header-bg);
  color: #fff;
  border-radius: 14px;
  padding: 18px 20px 22px;
  position: relative;
  box-shadow: 0 10px 30px var(--shadow);
}
.app-header h1{
  margin: 0 0 8px;
  font-size: 20px;
  font-weight: 700;
  letter-spacing: .2px;
}
.version-info{
  position: absolute;
  right: 16px;
  top: 14px;
  font-size: 12px;
  opacity: .9;
  text-align: right;
}
.theme-toggle{
  position:absolute;
  left: 16px;
  top: 12px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: 8px 12px;
  border-radius: 999px;
  background: var(--inactive-tab-bg);
  color:#fff;
  border: 1px solid transparent;
  cursor: pointer;
  font-weight: 700;
  font-size: 13px;
}
.theme-toggle:hover{ background: var(--accent-primary); }
.theme-toggle .sun{ display:none; }
.theme-toggle .moon{ display:block; }
body.dark-mode .theme-toggle{
  background: var(--input-bg);
  color: var(--text-primary);
  border-color: var(--panel-border);
}
body.dark-mode .theme-toggle:hover{
  border-color: var(--accent-primary);
  color: var(--accent-primary);
}
body.dark-mode .theme-toggle .sun{ display:block; }
body.dark-mode .theme-toggle .moon{ display:none; }

/* 패널 */
.panel{
  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  border-radius: 14px;
  box-shadow: 0 10px 30px var(--shadow);
  padding: 16px;
}
.panel-title{
  margin: 0 0 12px;
  font-size: 16px;
  font-weight: 800;
}

/* 입력줄 */
.controls{
  display:flex;
  gap:10px;
  flex-wrap: wrap;
  align-items: center;
  margin-bottom: 12px;
}
.input-wrapper{
  display:flex;
  align-items:center;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: 8px;
  overflow:hidden;
}
.input-wrapper input[type="file"]{
  padding:10px;
}
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:6px;
  padding:10px 14px;
  font-size:13px; font-weight:800;
  border-radius: 10px;
  border: 1px solid var(--input-border);
  background: #f7f9fb;
  color: var(--text-primary);
  cursor:pointer;
}
.btn:hover{ background:#eef3f8; }
.btn.primary{
  background: var(--accent-secondary);
  border-color: transparent;
  color:#fff;
}
.btn.primary:hover{ background: var(--accent-secondary-dark); }
.btn.danger{
  background:#e74c3c; color:#fff; border-color: transparent;
}
.btn.danger:hover{ background:#c0392b; }
.note{ color: var(--text-secondary); font-size: 12px; }

/* =========================
   썸네일 그리드
   PC: 6열 / 모바일: 2열
   ========================= */
.thumb-grid{
  display:grid;
  grid-template-columns: repeat(6, 1fr); /* PC 6열 */
  gap: 10px;
  width: 100%;
}
@media (max-width: 768px){
  .thumb-grid{ grid-template-columns: repeat(2, 1fr); } /* 모바일 2열 */
}

/* 썸네일 카드 */
.thumb{
  position: relative;
  width: 100%;
  aspect-ratio: 4/3;               /* 균일한 셀 비율 */
  border: 1px solid var(--panel-border);
  border-radius: 10px;
  overflow: hidden;
  background: var(--input-bg);
  user-select: none;
}
.thumb.dragging{
  opacity: .6;
  outline: 2px dashed var(--accent-primary);
  outline-offset: -2px;
}
.thumb img{
  width:100%; height:100%;
  object-fit: cover;                /* 보기 좋게 중앙 크롭 */
  display:block; pointer-events:none;
}
.order-badge{
  position:absolute; left:6px; top:6px;
  min-width:22px; height:22px; padding:0 7px;
  border-radius: 999px;
  color:#fff; background: rgba(0,0,0,.55);
  font-size:12px; font-weight:800;
  display:flex; align-items:center; justify-content:center;
  pointer-events:none;
}
.file-name{
  position:absolute; left:0; right:0; bottom:0;
  font-size:11px; color:#fff;
  background: linear-gradient(to top, rgba(0,0,0,.55), rgba(0,0,0,0));
  padding: 16px 8px 6px;
  white-space: nowrap; overflow:hidden; text-overflow: ellipsis;
}
.thumb-actions{
  position:absolute; right:6px; top:6px;
  display:flex; gap:6px;
}
.icon-btn{
  width:26px; height:26px; border-radius:6px;
  background: rgba(0,0,0,.55); color:#fff; border:none;
  display:grid; place-items:center; cursor:pointer;
}
.icon-btn:hover{ background: rgba(0,0,0,.75); }

/* 드롭 영역 강조 */
.dropzone{
  border: 2px dashed var(--accent-primary);
  border-radius: 10px;
  padding: 14px;
  text-align:center;
  color: var(--text-secondary);
}
.dropzone.dragover{
  background: rgba(52,152,219,.08);
  color: var(--accent-primary);
}

/* 토스트 */
#toast{
  position: fixed;
  left: 50%; bottom: 20px; transform: translateX(-50%);
  background: var(--accent-primary);
  color:#fff; padding:10px 14px;
  border-radius: 10px; font-weight:800; font-size: 12px;
  opacity:0; pointer-events:none;
  transition: opacity .2s;
}
#toast.show{ opacity:1; }

/* 툴바 */
.toolbar{
  display:flex; gap:8px; flex-wrap:wrap;
  align-items:center;
  margin: 10px 0 6px;
}
.sep{ width:1px; height:22px; background: var(--panel-border); }

/* 접근성 포커스 */
:focus-visible{ outline: 2px solid var(--accent-primary); outline-offset: 2px; }
</style>
</head>
<body>
<div class="container">

  <!-- 헤더 -->
  <header class="app-header">
    <button id="themeBtn" class="theme-toggle" type="button" aria-label="테마 전환">
      <span class="moon">🌙</span>
      <span class="sun">☀️</span>
      <span id="themeLabel">다크 모드</span>
    </button>
    <div class="version-info">
      <div>Version: 1.0.0</div>
      <div>Last Updated: 2025-11-02</div>
    </div>
    <h1>이미지 썸네일 그리드</h1>
    <div class="note">PC 6열 · 모바일 2열 · 가로 스크롤 없이 한 눈에 정렬</div>
  </header>

  <!-- 컨트롤 + 그리드 -->
  <section class="panel">
    <h2 class="panel-title">이미지 선택</h2>

    <!-- 업로드/붙여넣기/드래그 안내 및 버튼 -->
    <div class="controls">
      <label class="input-wrapper">
        <input id="fileInput" type="file" accept="image/*" multiple />
      </label>
      <button id="sortAsc" class="btn" type="button">파일명 오름차순</button>
      <button id="sortDesc" class="btn" type="button">파일명 내림차순</button>
      <span class="sep"></span>
      <button id="clearAll" class="btn danger" type="button">전체 비우기</button>
      <span class="note">팁: 바탕화면에서 이 창으로 **드래그 앤 드롭**, 혹은 이미지 **Ctrl+V 붙여넣기**도 가능</span>
    </div>

    <!-- 드래그 드롭 가능 드롭존 -->
    <div id="dropzone" class="dropzone">여기로 파일을 드래그하거나, 위에서 파일 선택 / Ctrl+V 로 붙여넣기</div>

    <!-- 썸네일 그리드 (PC 6열 / 모바일 2열) -->
    <div id="thumbContainer" class="thumb-grid" aria-live="polite"></div>
  </section>
</div>

<!-- 토스트 -->
<div id="toast" role="status" aria-live="polite"></div>

<script>
/* ==============================
   유틸: 토스트, 파일명, 타입체크
   ============================== */
const toastEl = document.getElementById('toast');
function showToast(msg, ms=1800){
  toastEl.textContent = msg;
  toastEl.classList.add('show');
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=>toastEl.classList.remove('show'), ms);
}
function niceName(file){
  return file?.name || '(clipboard)';
}
function isImageFile(f){
  return f && f.type && f.type.startsWith('image/');
}

/* ==============================
   테마 토글
   ============================== */
const themeBtn = document.getElementById('themeBtn');
const themeLabel = document.getElementById('themeLabel');
const THEME_KEY = 'thumbGridTheme';
function applyTheme(mode){
  if(mode==='dark'){ document.body.classList.add('dark-mode'); themeLabel.textContent='라이트 모드'; }
  else{ document.body.classList.remove('dark-mode'); themeLabel.textContent='다크 모드'; }
}
function initTheme(){
  const saved = localStorage.getItem(THEME_KEY);
  const prefersDark = matchMedia('(prefers-color-scheme: dark)').matches;
  applyTheme(saved || (prefersDark ? 'dark' : 'light'));
}
themeBtn.addEventListener('click', ()=>{
  const isDark = document.body.classList.contains('dark-mode');
  const next = isDark ? 'light' : 'dark';
  applyTheme(next);
  localStorage.setItem(THEME_KEY, next);
});
initTheme();

/* ==============================
   상태: 이미지 리스트
   ============================== */
const fileInput = document.getElementById('fileInput');
const dropzone = document.getElementById('dropzone');
const grid = document.getElementById('thumbContainer');
const sortAscBtn = document.getElementById('sortAsc');
const sortDescBtn = document.getElementById('sortDesc');
const clearAllBtn = document.getElementById('clearAll');

let items = []; // {id, file, url, name}

/* ==============================
   렌더: 썸네일 그리드
   ============================== */
function render(){
  grid.innerHTML = '';
  items.forEach((it, idx)=>{
    const card = document.createElement('div');
    card.className = 'thumb';
    card.draggable = true;
    card.dataset.id = it.id;

    const img = document.createElement('img');
    img.src = it.url;
    img.alt = it.name;

    const badge = document.createElement('div');
    badge.className = 'order-badge';
    badge.textContent = (idx + 1);

    const name = document.createElement('div');
    name.className = 'file-name';
    name.title = it.name;
    name.textContent = it.name;

    const actions = document.createElement('div');
    actions.className = 'thumb-actions';

    const del = document.createElement('button');
    del.type = 'button';
    del.className = 'icon-btn';
    del.title = '삭제';
    del.innerHTML = '✕';
    del.addEventListener('click', ()=>{
      removeById(it.id);
    });

    actions.appendChild(del);

    card.appendChild(img);
    card.appendChild(badge);
    card.appendChild(name);
    card.appendChild(actions);

    // DnD 이벤트
    card.addEventListener('dragstart', onDragStart);
    card.addEventListener('dragover', onDragOver);
    card.addEventListener('drop', onDrop);
    card.addEventListener('dragend', onDragEnd);

    grid.appendChild(card);
  });
}

/* ==============================
   데이터 조작
   ============================== */
function addFiles(fileList){
  const arr = Array.from(fileList || []).filter(isImageFile);
  if(arr.length === 0){ showToast('이미지 파일이 아닙니다.'); return; }

  const start = performance.now();

  const newItems = arr.map((f, i)=>({
    id: crypto.randomUUID(),
    file: f,
    url: URL.createObjectURL(f),
    name: niceName(f)
  }));
  items = items.concat(newItems);
  render();

  const dt = (performance.now() - start).toFixed(1);
  showToast(`${newItems.length}장 추가됨 (${dt}ms)`);
}

function removeById(id){
  const idx = items.findIndex(x=>x.id===id);
  if(idx>=0){
    URL.revokeObjectURL(items[idx].url);
    items.splice(idx,1);
    render();
  }
}

function clearAll(){
  items.forEach(x=>URL.revokeObjectURL(x.url));
  items = [];
  render();
}

/* ==============================
   정렬 (파일명)
   ============================== */
function sortByName(direction='asc'){
  items.sort((a,b)=>{
    const A = (a.name||'').toLowerCase();
    const B = (b.name||'').toLowerCase();
    if(A<B) return direction==='asc' ? -1 : 1;
    if(A>B) return direction==='asc' ? 1 : -1;
    return 0;
  });
  render();
}

/* ==============================
   드래그 앤 드롭 정렬
   ============================== */
let dragId = null;

function onDragStart(e){
  const el = e.currentTarget;
  dragId = el.dataset.id;
  el.classList.add('dragging');
  e.dataTransfer.effectAllowed = 'move';
}

function onDragOver(e){
  e.preventDefault();
  e.dataTransfer.dropEffect = 'move';

  const over = e.currentTarget;
  const draggingIdx = items.findIndex(x=>x.id===dragId);
  const overIdx = items.findIndex(x=>x.id===over.dataset.id);
  if(draggingIdx < 0 || overIdx < 0 || draggingIdx === overIdx) return;

  const rect = over.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const toRightHalf = x > rect.width/2;

  // 미리보기 이동: 배열에서 요소를 빼서 새 위치로 삽입
  const moving = items.splice(draggingIdx,1)[0];
  let insertAt = overIdx + (toRightHalf ? 1 : 0);
  if(insertAt < 0) insertAt = 0;
  if(insertAt > items.length) insertAt = items.length;
  items.splice(insertAt, 0, moving);
  dragId = moving.id; // 최신 인덱스 유지
  render(); // 즉시 재렌더로 위치 반영
}

function onDrop(e){
  e.preventDefault();
}

function onDragEnd(e){
  e.currentTarget.classList.remove('dragging');
  dragId = null;
}

/* ==============================
   입력 소스: 파일/드래그/붙여넣기
   ============================== */
fileInput.addEventListener('change', (e)=> addFiles(e.target.files));

;['dragenter','dragover','dragleave','drop'].forEach(ev=>{
  dropzone.addEventListener(ev, (e)=>{ e.preventDefault(); e.stopPropagation(); }, false);
});
dropzone.addEventListener('dragover', ()=> dropzone.classList.add('dragover'));
dropzone.addEventListener('dragleave', ()=> dropzone.classList.remove('dragover'));
dropzone.addEventListener('drop', (e)=>{
  dropzone.classList.remove('dragover');
  const dt = e.dataTransfer;
  if(dt?.files?.length) addFiles(dt.files);
});

window.addEventListener('paste', (e)=>{
  const files = [];
  for(const item of e.clipboardData.items){
    if(item.kind==='file'){
      const f = item.getAsFile();
      if(isImageFile(f)) files.push(f);
    }
  }
  if(files.length) addFiles(files);
});

/* 버튼들 */
sortAscBtn.addEventListener('click', ()=> sortByName('asc'));
sortDescBtn.addEventListener('click', ()=> sortByName('desc'));
clearAllBtn.addEventListener('click', clearAll);
</script>
</body>
</html>
